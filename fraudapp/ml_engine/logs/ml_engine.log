2026-01-01 09:51:54 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 09:51:54 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 09:51:54 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.9000000000000002 (demo override active)
2026-01-01 09:51:54 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 09:51:54 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 09:51:57 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 09:57:27 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 09:57:27 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 09:57:27 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.9000000000000002 (demo override active)
2026-01-01 09:57:28 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 09:57:28 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 09:57:36 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 10:04:44 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 10:04:44 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 10:04:44 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.9000000000000002 (demo override active)
2026-01-01 10:04:44 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 10:04:44 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 10:04:48 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 11:27:22 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 11:27:22 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 11:27:22 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.9000000000000002 (demo override active)
2026-01-01 11:27:22 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 11:27:22 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 11:27:27 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 11:41:08 | INFO | __main__ | Starting FULL training pipeline
2026-01-01 11:41:14 | INFO | __main__ | Sequences | Train=799705 | Val=199927 | Fraud Ratio=0.0526
2026-01-01 11:41:14 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 11:41:20 | INFO | fraudapp.ml_engine.training.deep_trainer | Training unified CNN-RNN deep model
2026-01-01 11:41:20 | INFO | fraudapp.ml_engine.training.deep_trainer | Deep model pos_weight=18.00 (pos=42098, neg=757607)
2026-01-01 11:43:21 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 1/5 | Train Loss: 0.6807
2026-01-01 11:45:25 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 2/5 | Train Loss: 0.5433
2026-01-01 11:47:22 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 3/5 | Train Loss: 0.5063
2026-01-01 11:49:12 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 4/5 | Train Loss: 0.4851
2026-01-01 11:51:03 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 5/5 | Train Loss: 0.4687
2026-01-01 11:51:03 | INFO | fraudapp.ml_engine.training.deep_trainer | Saved deep_model.pt
2026-01-01 11:51:35 | INFO | fraudapp.ml_engine.training.smote_handler | Before SMOTE: {0: 757607, 1: 42098}
2026-01-01 11:52:16 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:17 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9497001522337889, 'precision': 0.8136064504654058, 'recall': 0.9056896403798813, 'f1_score': 0.8571821194224697, 'specificity': 0.9585022313679784, 'false_positive_rate': 0.04149776863202161, 'true_positives': 137231, 'false_positives': 31439, 'false_negatives': 14290, 'true_negatives': 726168, 'roc_auc': 0.9625223240267011}
2026-01-01 11:52:17 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9553837150559954, 'precision': 0.5463476652797041, 'recall': 0.8983276320790574, 'f1_score': 0.6794595371568205, 'specificity': 0.958553982777464, 'false_positive_rate': 0.041446017222536075, 'true_positives': 9454, 'false_positives': 7850, 'false_negatives': 1070, 'true_negatives': 181553, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:18 | INFO | __main__ | [XGBOOST METRICS] TRAIN | Acc=0.9497 | Prec=0.8136 | Recall=0.9057 | F1=0.8572 | AUC=0.9625
2026-01-01 11:52:18 | INFO | __main__ | [XGBOOST METRICS] VAL   | Acc=0.9554 | Prec=0.5463 | Recall=0.8983 | F1=0.6795 | AUC=0.9569
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.6634621636897468, 'precision': 0.13073970463860515, 'recall': 0.9547700494108704, 'f1_score': 0.22998661005504756, 'specificity': 0.6472759143202589, 'false_positive_rate': 0.35272408567974106, 'true_positives': 10048, 'false_positives': 66807, 'false_negatives': 476, 'true_negatives': 122596, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8734738179435494, 'precision': 0.2853905160390516, 'recall': 0.9332953249714937, 'f1_score': 0.43711615487316424, 'specificity': 0.8701498920291654, 'false_positive_rate': 0.12985010797083468, 'true_positives': 9822, 'false_positives': 24594, 'false_negatives': 702, 'true_negatives': 164809, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8955918910402297, 'precision': 0.326946227929374, 'recall': 0.9290193842645382, 'f1_score': 0.4836746809142179, 'specificity': 0.8937345237403843, 'false_positive_rate': 0.10626547625961574, 'true_positives': 9777, 'false_positives': 20127, 'false_negatives': 747, 'true_negatives': 169276, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9127881676812036, 'precision': 0.3688823127703164, 'recall': 0.9238882554161916, 'f1_score': 0.5272490645843501, 'specificity': 0.9121714017201417, 'false_positive_rate': 0.0878285982798583, 'true_positives': 9723, 'false_positives': 16635, 'false_negatives': 801, 'true_negatives': 172768, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9322302640463769, 'precision': 0.43215359081325977, 'recall': 0.9154313949068795, 'f1_score': 0.5871347167626535, 'specificity': 0.9331636774496708, 'false_positive_rate': 0.06683632255032919, 'true_positives': 9634, 'false_positives': 12659, 'false_negatives': 890, 'true_negatives': 176744, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:18 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9405683074322128, 'precision': 0.466923226812159, 'recall': 0.9107753705815279, 'f1_score': 0.6173515393533427, 'specificity': 0.942223724017043, 'false_positive_rate': 0.057776275982956975, 'true_positives': 9585, 'false_positives': 10943, 'false_negatives': 939, 'true_negatives': 178460, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.945910257243894, 'precision': 0.4925172876457839, 'recall': 0.9068795134929685, 'f1_score': 0.6383519497023611, 'specificity': 0.9480789639023669, 'false_positive_rate': 0.051921036097633086, 'true_positives': 9544, 'false_positives': 9834, 'false_negatives': 980, 'true_negatives': 179569, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9506619916269439, 'precision': 0.5179816913687881, 'recall': 0.903268719118206, 'f1_score': 0.6584014406427483, 'specificity': 0.9532953543502479, 'false_positive_rate': 0.046704645649752116, 'true_positives': 9506, 'false_positives': 8846, 'false_negatives': 1018, 'true_negatives': 180557, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9553837150559954, 'precision': 0.5463476652797041, 'recall': 0.8983276320790574, 'f1_score': 0.6794595371568205, 'specificity': 0.958553982777464, 'false_positive_rate': 0.041446017222536075, 'true_positives': 9454, 'false_positives': 7850, 'false_negatives': 1070, 'true_negatives': 181553, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.959860349027395, 'precision': 0.5767364736227968, 'recall': 0.8923413150893197, 'f1_score': 0.7006378930876264, 'specificity': 0.9636119808028384, 'false_positive_rate': 0.03638801919716161, 'true_positives': 9391, 'false_positives': 6892, 'false_negatives': 1133, 'true_negatives': 182511, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.962971484591876, 'precision': 0.6004118139115887, 'recall': 0.886640060813379, 'f1_score': 0.7159792825628237, 'specificity': 0.967212768541153, 'false_positive_rate': 0.03278723145884701, 'true_positives': 9331, 'false_positives': 6210, 'false_negatives': 1193, 'true_negatives': 183193, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9653523536090673, 'precision': 0.620421827920991, 'recall': 0.8804637020144431, 'f1_score': 0.7279154719352685, 'specificity': 0.970069111893687, 'false_positive_rate': 0.029930888106312992, 'true_positives': 9266, 'false_positives': 5669, 'false_negatives': 1258, 'true_negatives': 183734, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:19 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9676281842872648, 'precision': 0.6414014517029593, 'recall': 0.8732421132649183, 'f1_score': 0.7395783035570578, 'specificity': 0.9728726577720522, 'false_positive_rate': 0.027127342227947816, 'true_positives': 9190, 'false_positives': 5138, 'false_negatives': 1334, 'true_negatives': 184265, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9697739674981368, 'precision': 0.6631946973559618, 'recall': 0.8651653363740023, 'f1_score': 0.7508349482538242, 'specificity': 0.9755864479443304, 'false_positive_rate': 0.024413552055669658, 'true_positives': 9105, 'false_positives': 4624, 'false_negatives': 1419, 'true_negatives': 184779, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9717096740310214, 'precision': 0.6865705963513721, 'recall': 0.8511022424933485, 'f1_score': 0.760033941450997, 'specificity': 0.978411112812363, 'false_positive_rate': 0.021588887187636942, 'true_positives': 8957, 'false_positives': 4089, 'false_negatives': 1567, 'true_negatives': 185314, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9737804298568977, 'precision': 0.7169377361590275, 'recall': 0.8293424553401748, 'f1_score': 0.7690545422504186, 'specificity': 0.9818059904014192, 'false_positive_rate': 0.018194009598580804, 'true_positives': 8728, 'false_positives': 3446, 'false_negatives': 1796, 'true_negatives': 185957, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 11:52:20 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9748408168981678, 'precision': 0.750364564345607, 'recall': 0.7823071075636641, 'f1_score': 0.766002977298102, 'specificity': 0.9855387718251559, 'false_positive_rate': 0.014461228174844116, 'true_positives': 8233, 'false_positives': 2739, 'false_negatives': 2291, 'true_negatives': 186664, 'roc_auc': 0.9568777347137551}
2026-01-01 11:52:20 | INFO | __main__ | [TRAINING COMPLETE] Best Threshold=0.85 | Val F1=0.7691
2026-01-01 11:57:21 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 11:57:21 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 11:57:21 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002 (demo override active)
2026-01-01 11:57:21 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 11:57:21 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 11:57:23 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 12:32:46 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 12:32:46 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 12:32:46 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002 (demo override active)
2026-01-01 12:32:47 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 12:32:47 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 12:32:49 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 12:35:42 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 12:35:42 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 12:35:42 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002 (demo override active)
2026-01-01 12:35:42 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 12:35:42 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 12:35:44 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.066, mean=0.074, max=0.089
2026-01-01 12:35:44 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 14:22:18 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 14:22:18 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 14:22:18 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002 (demo override active)
2026-01-01 14:22:27 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 14:22:27 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 14:22:28 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.065, mean=0.065, max=0.065
2026-01-01 14:22:28 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 14:45:54 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 14:45:54 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 14:45:54 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002 (demo override active)
2026-01-01 14:46:19 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 14:46:19 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 14:46:21 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.065, mean=0.065, max=0.065
2026-01-01 14:46:30 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 16:40:31 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 16:40:31 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 16:40:31 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002 (demo override active)
2026-01-01 16:40:38 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 16:40:38 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 16:40:39 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.065, mean=0.065, max=0.065
2026-01-01 16:40:43 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 17:12:30 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 17:12:30 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 17:12:30 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002 (demo override active)
2026-01-01 17:12:45 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 17:12:45 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 17:12:45 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.065, mean=0.065, max=0.065
2026-01-01 17:12:46 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 17:35:02 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 17:35:02 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 17:35:02 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8500000000000002
2026-01-01 17:35:09 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 17:35:09 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 17:35:09 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.065, mean=0.065, max=0.065
2026-01-01 17:35:09 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 19:40:42 | INFO | __main__ | Starting FULL training pipeline
2026-01-01 19:40:52 | INFO | __main__ | Sequences | Train=799705 | Val=199927 | Fraud Ratio=0.1169
2026-01-01 19:40:52 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 19:40:53 | INFO | fraudapp.ml_engine.training.deep_trainer | Training unified CNN-RNN deep model
2026-01-01 19:40:53 | INFO | fraudapp.ml_engine.training.deep_trainer | Deep model pos_weight=7.55 (pos=93494, neg=706211)
2026-01-01 19:42:38 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 1/5 | Train Loss: 0.7887
2026-01-01 19:44:27 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 2/5 | Train Loss: 0.5988
2026-01-01 19:46:20 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 3/5 | Train Loss: 0.5509
2026-01-01 19:48:11 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 4/5 | Train Loss: 0.5265
2026-01-01 19:50:25 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 5/5 | Train Loss: 0.5114
2026-01-01 19:50:25 | INFO | fraudapp.ml_engine.training.deep_trainer | Saved deep_model.pt
2026-01-01 19:50:55 | INFO | fraudapp.ml_engine.training.smote_handler | Before SMOTE: {0: 706211, 1: 93494}
2026-01-01 19:53:08 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.900314235715727, 'precision': 0.6455424219891798, 'recall': 0.8912646379971964, 'f1_score': 0.7487590967354355, 'specificity': 0.9021241526965736, 'false_positive_rate': 0.09787584730342631, 'true_positives': 125884, 'false_positives': 69121, 'false_negatives': 15358, 'true_negatives': 637090, 'roc_auc': 0.9578756530330503}
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8978026979847644, 'precision': 0.5386008662554141, 'recall': 0.8778505112736918, 'f1_score': 0.6675994013145051, 'specificity': 0.9004440567758306, 'false_positive_rate': 0.09955594322416937, 'true_positives': 20518, 'false_positives': 17577, 'false_negatives': 2855, 'true_negatives': 158977, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:09 | INFO | __main__ | [XGBOOST METRICS] TRAIN | Acc=0.9003 | Prec=0.6455 | Recall=0.8913 | F1=0.7488 | AUC=0.9579
2026-01-01 19:53:09 | INFO | __main__ | [XGBOOST METRICS] VAL   | Acc=0.8978 | Prec=0.5386 | Recall=0.8779 | F1=0.6676 | AUC=0.9466
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.6699145187993618, 'precision': 0.25711224582839426, 'recall': 0.9651307063705985, 'f1_score': 0.4060517149825847, 'specificity': 0.6308324931748927, 'false_positive_rate': 0.36916750682510735, 'true_positives': 22558, 'false_positives': 65178, 'false_negatives': 815, 'true_negatives': 111376, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.7551056135489453, 'precision': 0.3171292987621852, 'recall': 0.9492576904975827, 'f1_score': 0.47542722451384795, 'specificity': 0.7294029022282135, 'false_positive_rate': 0.27059709777178653, 'true_positives': 22187, 'false_positives': 47775, 'false_negatives': 1186, 'true_negatives': 128779, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8035132823480571, 'precision': 0.3667638093323954, 'recall': 0.9368929961921876, 'f1_score': 0.5271608950516978, 'specificity': 0.7858558854514766, 'false_positive_rate': 0.2141441145485234, 'true_positives': 21898, 'false_positives': 37808, 'false_negatives': 1475, 'true_negatives': 138746, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:09 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8347596872858594, 'precision': 0.4088344623280563, 'recall': 0.9270097976297437, 'f1_score': 0.5674217624721749, 'specificity': 0.8225472093523795, 'false_positive_rate': 0.17745279064762057, 'true_positives': 21667, 'false_positives': 31330, 'false_negatives': 1706, 'true_negatives': 145224, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8553772126826291, 'precision': 0.442702624449362, 'recall': 0.915843066786463, 'f1_score': 0.596882580932995, 'specificity': 0.8473724752766859, 'false_positive_rate': 0.15262752472331412, 'true_positives': 21406, 'false_positives': 26947, 'false_negatives': 1967, 'true_negatives': 149607, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.870302660471072, 'precision': 0.4715566530957307, 'recall': 0.906858340820605, 'f1_score': 0.6204736395304588, 'specificity': 0.8654632577001937, 'false_positive_rate': 0.13453674229980628, 'true_positives': 21196, 'false_positives': 23753, 'false_negatives': 2177, 'true_negatives': 152801, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8814367244044076, 'precision': 0.49608941187590083, 'recall': 0.898258674538998, 'f1_score': 0.6391755715894907, 'specificity': 0.8792097601866851, 'false_positive_rate': 0.12079023981331491, 'true_positives': 20995, 'false_positives': 21326, 'false_negatives': 2378, 'true_negatives': 155228, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8902649467055476, 'precision': 0.5178945792153339, 'recall': 0.8878192786548582, 'f1_score': 0.6541826263772639, 'specificity': 0.8905887150673448, 'false_positive_rate': 0.10941128493265516, 'true_positives': 20751, 'false_positives': 19317, 'false_negatives': 2622, 'true_negatives': 157237, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:10 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8978026979847644, 'precision': 0.5386008662554141, 'recall': 0.8778505112736918, 'f1_score': 0.6675994013145051, 'specificity': 0.9004440567758306, 'false_positive_rate': 0.09955594322416937, 'true_positives': 20518, 'false_positives': 17577, 'false_negatives': 2855, 'true_negatives': 158977, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9051603835399921, 'precision': 0.5610877270713336, 'recall': 0.8668977024772173, 'f1_score': 0.6812473732873834, 'specificity': 0.9102257666209772, 'false_positive_rate': 0.08977423337902285, 'true_positives': 20262, 'false_positives': 15850, 'false_negatives': 3111, 'true_negatives': 160704, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9118528262815928, 'precision': 0.5843405303919268, 'recall': 0.8522226500663158, 'f1_score': 0.693305024277336, 'specificity': 0.9197469329496925, 'false_positive_rate': 0.08025306705030756, 'true_positives': 19919, 'false_positives': 14169, 'false_negatives': 3454, 'true_negatives': 162385, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9186052909311899, 'precision': 0.6110138220026268, 'recall': 0.8359645745090489, 'f1_score': 0.7060035049050605, 'specificity': 0.9295456347633019, 'false_positive_rate': 0.07045436523669812, 'true_positives': 19539, 'false_positives': 12439, 'false_negatives': 3834, 'true_negatives': 164115, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.925167686205465, 'precision': 0.6418549747048904, 'recall': 0.8142300945535447, 'f1_score': 0.7178394281726798, 'specificity': 0.9398540956307985, 'false_positive_rate': 0.06014590436920149, 'true_positives': 19031, 'false_positives': 10619, 'false_negatives': 4342, 'true_negatives': 165935, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:11 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:12 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9305396469711444, 'precision': 0.6742340753802072, 'recall': 0.7852650494159928, 'f1_score': 0.7255262377705307, 'specificity': 0.9497717412236483, 'false_positive_rate': 0.05022825877635171, 'true_positives': 18354, 'false_positives': 8868, 'false_negatives': 5019, 'true_negatives': 167686, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:12 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:12 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9347661896592256, 'precision': 0.7097494619726317, 'recall': 0.7478286912249177, 'f1_score': 0.7282916666666667, 'specificity': 0.9595138031423813, 'false_positive_rate': 0.04048619685761863, 'true_positives': 17479, 'false_positives': 7148, 'false_negatives': 5894, 'true_negatives': 169406, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:12 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:12 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9380974055530269, 'precision': 0.7552100255279647, 'recall': 0.6961451247165533, 'f1_score': 0.7244757112961396, 'specificity': 0.9701281194422103, 'false_positive_rate': 0.029871880557789686, 'true_positives': 16271, 'false_positives': 5274, 'false_negatives': 7102, 'true_negatives': 171280, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:12 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-01 19:53:12 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9378623197467075, 'precision': 0.8100577641862046, 'recall': 0.6119881915030163, 'f1_score': 0.6972289244717409, 'specificity': 0.9810029792584705, 'false_positive_rate': 0.018997020741529504, 'true_positives': 14304, 'false_positives': 3354, 'false_negatives': 9069, 'true_negatives': 173200, 'roc_auc': 0.9465641330786505}
2026-01-01 19:53:12 | INFO | __main__ | [TRAINING COMPLETE] Best Threshold=0.80 | Val F1=0.7283
2026-01-01 19:55:31 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 19:55:31 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 19:55:31 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8000000000000002
2026-01-01 19:55:39 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 19:55:39 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 19:55:40 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.014, mean=0.014, max=0.014
2026-01-01 19:55:40 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 20:18:10 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 20:18:10 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 20:18:10 | INFO | fraudapp.ml_engine.inference.predictor | Loaded trained threshold=0.8000000000000002
2026-01-01 20:18:11 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 20:18:11 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 20:18:23 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 20:18:23 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 20:27:12 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 20:27:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 20:27:12 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.60
2026-01-01 20:27:14 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 20:27:14 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 20:27:25 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 20:27:25 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 20:32:35 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 20:32:35 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 20:32:35 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.40
2026-01-01 20:32:37 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 20:32:37 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 20:32:48 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 20:32:49 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 20:40:27 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 20:40:27 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 20:40:27 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-01 20:40:29 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 20:40:29 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 20:40:40 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 20:40:58 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 22:30:57 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 22:30:57 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 22:30:57 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-01 22:31:02 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 22:31:02 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 22:31:16 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 22:31:39 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 22:47:49 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 22:47:49 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 22:47:49 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-01 22:47:51 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 22:47:51 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 22:48:02 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 22:48:13 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 23:09:12 | INFO | fraudapp.views | Loading FraudPredictor
2026-01-01 23:09:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 23:09:12 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-01 23:09:13 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 23:09:13 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 23:09:23 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 23:09:32 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 23:34:27 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 23:34:27 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-01 23:34:30 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 23:34:30 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 23:34:40 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 23:34:50 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 23:53:41 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 23:53:41 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-01 23:53:43 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 23:53:43 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 23:53:53 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 23:54:02 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-01 23:58:22 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-01 23:58:22 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-01 23:58:22 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-01 23:58:25 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-01 23:58:25 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-01 23:58:44 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-01 23:58:56 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-02 00:17:40 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 00:17:40 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 00:17:40 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 00:17:42 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 00:17:42 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 00:17:53 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 00:18:05 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations
2026-01-02 08:23:40 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 08:23:40 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 08:23:40 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 08:23:42 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 08:23:42 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 08:23:54 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 08:25:17 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (engineered features)
2026-01-02 08:25:17 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\shap\explainers\_tree.py", line 405, in shap_values
    phi = self.model.original_model.predict(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\xgboost\core.py", line 2297, in predict
    _check_call(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\xgboost\core.py", line 282, in _check_call
    raise XGBoostError(py_str(_LIB.XGBGetLastError()))
xgboost.core.XGBoostError: [08:25:17] C:\buildkite-agent\builds\buildkite-windows-cpu-autoscaling-group-i-0b3782d1791676daf-1\xgboost\xgboost-ci-windows\src\c_api\c_api_utils.h:125: Check failed: std::accumulate(shape.cbegin(), shape.cend(), static_cast<bst_ulong>(1), std::multiplies<>{}) == chunksize * rows (3200 vs. 25800) : 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 192, in run_detection
    output = predictor.predict(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\inference\predictor.py", line 241, in predict
    ).explain(X_seq_features)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\explainability\shap_explainer.py", line 28, in explain
    shap_values = self.explainer.shap_values(X_sample)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\shap\explainers\_tree.py", line 414, in shap_values
    raise ValueError(emsg) from e
ValueError: This reshape error is often caused by passing a bad data matrix to SHAP. See https://github.com/shap/shap/issues/580.
2026-01-02 08:31:43 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 08:31:43 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 08:31:43 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 08:31:45 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 08:31:45 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 08:31:56 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 08:33:18 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\shap\explainers\_tree.py", line 405, in shap_values
    phi = self.model.original_model.predict(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\xgboost\core.py", line 2297, in predict
    _check_call(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\xgboost\core.py", line 282, in _check_call
    raise XGBoostError(py_str(_LIB.XGBGetLastError()))
xgboost.core.XGBoostError: [08:33:18] C:\buildkite-agent\builds\buildkite-windows-cpu-autoscaling-group-i-0b3782d1791676daf-1\xgboost\xgboost-ci-windows\src\c_api\c_api_utils.h:125: Check failed: std::accumulate(shape.cbegin(), shape.cend(), static_cast<bst_ulong>(1), std::multiplies<>{}) == chunksize * rows (3200 vs. 25800) : 

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 192, in run_detection
    output = predictor.predict(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\inference\predictor.py", line 241, in predict
    ).explain(X_seq_features)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\explainability\shap_explainer.py", line 60, in explain
    shap_values = self.explainer.shap_values(X_sample)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\shap\explainers\_tree.py", line 414, in shap_values
    raise ValueError(emsg) from e
ValueError: This reshape error is often caused by passing a bad data matrix to SHAP. See https://github.com/shap/shap/issues/580.
2026-01-02 08:37:05 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 08:37:05 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 08:37:05 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 08:37:07 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 08:37:07 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 08:37:18 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 08:38:36 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (latent to behavioral mapping)
2026-01-02 08:45:09 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 08:45:09 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 08:45:09 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 08:45:11 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 08:45:11 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 08:45:23 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 08:46:52 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (latent to behavioral mapping)
2026-01-02 08:54:34 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 08:54:34 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 08:54:34 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 08:54:35 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 08:54:35 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 08:54:46 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 08:56:03 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (latent to behavioral mapping)
2026-01-02 09:15:08 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 09:15:08 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 09:15:08 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 09:15:10 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 09:15:10 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 09:15:21 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 09:16:40 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 09:20:03 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 09:20:03 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 09:20:03 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 09:20:05 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 09:20:05 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 09:20:16 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 09:22:36 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 09:25:36 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 09:25:36 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 09:25:36 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 09:25:37 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 09:25:37 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 09:25:48 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 09:27:07 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 09:27:51 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 09:27:51 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 09:27:51 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 09:27:53 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 09:27:53 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 09:28:04 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 10:15:35 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 10:29:43 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 10:29:43 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 10:29:43 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 10:29:45 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 10:29:45 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 10:29:57 | INFO | fraudapp.ml_engine.inference.predictor | Prob stats: min=0.042, mean=0.162, max=0.721
2026-01-02 10:31:32 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 10:45:43 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 10:45:43 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 10:45:43 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 10:45:49 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNN-RNN model
2026-01-02 10:45:49 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 10:48:36 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 11:15:20 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 11:15:20 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 11:15:20 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 11:15:24 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 11:15:24 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 11:15:55 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1
2026-01-02 11:15:55 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 11:16:18 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 11:24:57 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 11:24:57 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 11:24:58 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 11:25:02 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 11:25:02 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 11:25:33 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1
2026-01-02 11:25:33 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 11:25:57 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:22:57 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 12:22:57 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 12:22:57 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 12:22:58 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 12:22:58 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 12:23:04 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 22
2026-01-02 12:23:04 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 12:23:09 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:28:16 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 12:28:16 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 12:28:16 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.10
2026-01-02 12:28:17 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 12:28:17 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 12:28:23 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 22
2026-01-02 12:28:23 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 12:28:29 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:30:22 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1
2026-01-02 12:30:22 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 12:30:30 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:30:48 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1
2026-01-02 12:30:48 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 12:30:55 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:30:56 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\sqlite3\base.py", line 360, in execute
    return super().execute(query, params)
sqlite3.IntegrityError: UNIQUE constraint failed: fraudapp_predictionresult.dataset_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 196, in run_detection
    PredictionResult.objects.create(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\query.py", line 665, in create
    obj.save(force_insert=True, using=self.db)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 902, in save
    self.save_base(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1008, in save_base
    updated = self._save_table(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1169, in _save_table
    results = self._do_insert(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1210, in _do_insert
    return manager._insert(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\query.py", line 1873, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\sql\compiler.py", line 1882, in execute_sql
    cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\sqlite3\base.py", line 360, in execute
    return super().execute(query, params)
django.db.utils.IntegrityError: UNIQUE constraint failed: fraudapp_predictionresult.dataset_id
2026-01-02 12:46:55 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 12:46:55 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 12:46:55 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.30
2026-01-02 12:46:55 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 12:46:55 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 12:46:55 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 3
2026-01-02 12:46:55 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 3
2026-01-02 12:46:55 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:47:59 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 12:47:59 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 12:47:59 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.30
2026-01-02 12:47:59 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 12:47:59 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 12:47:59 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 3
2026-01-02 12:47:59 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 3
2026-01-02 12:47:59 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:48:29 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 12:48:29 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 12:48:29 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.30
2026-01-02 12:48:30 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 12:48:30 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 12:48:30 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 3
2026-01-02 12:48:30 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 3
2026-01-02 12:48:30 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 12:49:44 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 12:49:44 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 12:49:44 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.90
2026-01-02 12:49:44 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 12:49:44 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 12:49:44 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 3
2026-01-02 12:49:44 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 12:49:44 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 13:02:05 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 13:02:05 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 13:02:05 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.65
2026-01-02 13:02:05 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 13:02:05 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 13:02:07 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 6
2026-01-02 13:02:07 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 13:02:10 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 13:03:15 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 13:03:15 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 13:03:15 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.65
2026-01-02 13:03:16 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 13:03:16 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 13:03:20 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 6
2026-01-02 13:03:20 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 13:03:24 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 13:11:12 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 13:11:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 13:11:12 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.80
2026-01-02 13:11:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 13:11:12 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 13:11:14 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 6
2026-01-02 13:11:14 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 13:11:16 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 13:11:41 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 22
2026-01-02 13:11:41 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 13:11:49 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 13:11:56 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 22
2026-01-02 13:11:56 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 14:54:27 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 14:54:27 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 14:54:27 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.80
2026-01-02 14:54:28 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 14:54:28 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 14:54:30 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 200
2026-01-02 14:54:30 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 14:54:32 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 14:56:07 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 14:56:07 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 14:56:07 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.50
2026-01-02 14:56:07 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 14:56:07 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 14:56:09 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 200
2026-01-02 14:56:09 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 14:56:11 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 14:57:44 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 14:57:44 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 14:57:44 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 14:57:45 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 14:57:45 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 14:57:49 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 200
2026-01-02 14:57:49 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-02 14:57:51 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 15:52:22 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 15:52:22 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 15:52:22 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-02 15:52:25 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 15:52:25 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 15:52:32 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 15:52:32 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 1
2026-01-02 15:52:37 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 15:54:31 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 15:54:31 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 15:54:31 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.10
2026-01-02 15:54:32 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 15:54:32 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 15:54:39 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 15:54:39 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 15:54:45 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 16:05:36 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 16:05:36 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 16:05:36 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-02 16:05:39 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 16:05:39 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 16:06:12 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 16:06:12 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 16:06:29 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 19:10:59 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 19:10:59 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 19:10:59 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-02 19:11:01 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 19:11:01 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 19:11:12 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 19:11:12 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 19:11:18 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 19:11:18 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 19:11:24 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 19:11:27 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 19:11:27 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\sqlite3\base.py", line 360, in execute
    return super().execute(query, params)
sqlite3.IntegrityError: UNIQUE constraint failed: fraudapp_predictionresult.dataset_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 196, in run_detection
    PredictionResult.objects.create(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\query.py", line 665, in create
    obj.save(force_insert=True, using=self.db)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 902, in save
    self.save_base(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1008, in save_base
    updated = self._save_table(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1169, in _save_table
    results = self._do_insert(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1210, in _do_insert
    return manager._insert(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\query.py", line 1873, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\sql\compiler.py", line 1882, in execute_sql
    cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\sqlite3\base.py", line 360, in execute
    return super().execute(query, params)
django.db.utils.IntegrityError: UNIQUE constraint failed: fraudapp_predictionresult.dataset_id
2026-01-02 19:46:33 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 19:46:33 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 19:46:33 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-02 19:46:36 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 19:46:36 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 19:47:11 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 19:47:11 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 19:48:26 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 20:46:38 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 20:46:38 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 20:46:38 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-02 20:46:39 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 20:46:39 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 20:46:49 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 20:46:49 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 20:47:44 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 21:03:41 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 21:03:41 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 21:03:41 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-02 21:03:42 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 21:03:42 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 21:03:51 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 21:03:51 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 21:04:46 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 21:39:55 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 21:39:55 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 21:39:55 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-02 21:39:56 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 21:39:56 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 21:40:05 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 21:40:05 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 21:41:02 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-02 22:46:41 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-02 22:46:41 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-02 22:46:42 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-02 22:46:42 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-02 22:46:42 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-02 22:46:52 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-02 22:46:52 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-02 22:47:43 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 09:05:36 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 09:05:36 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 09:05:37 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-03 09:05:41 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 09:05:41 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 09:06:57 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-03 09:06:57 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-03 09:10:42 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 09:15:41 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 09:15:41 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 32
2026-01-03 09:15:47 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 09:17:59 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 09:17:59 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 09:18:00 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 09:18:01 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 09:18:01 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 09:18:09 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 09:18:09 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 32
2026-01-03 09:18:15 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 09:19:17 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 09:19:17 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 09:19:17 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.50
2026-01-03 09:19:19 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 09:19:19 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 09:19:27 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 09:19:27 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 32
2026-01-03 09:19:35 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 09:20:55 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 09:20:55 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 09:20:55 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.80
2026-01-03 09:20:56 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 09:20:56 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 09:21:00 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 09:21:00 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-03 09:21:07 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 09:25:12 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 09:25:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 09:25:12 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.60
2026-01-03 09:25:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 09:25:12 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 09:25:14 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 09:25:14 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 32
2026-01-03 09:25:16 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 09:26:12 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 09:26:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 09:26:12 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.65
2026-01-03 09:26:13 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 09:26:13 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 09:26:13 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 09:26:13 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 0
2026-01-03 09:26:14 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 15:04:14 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 15:04:14 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 15:04:14 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.60
2026-01-03 15:04:15 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 15:04:15 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 15:04:21 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 15:04:21 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 32
2026-01-03 15:04:23 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 15:07:54 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 15:07:54 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 15:07:54 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-03 15:07:55 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 15:07:55 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 15:08:06 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-03 15:08:06 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-03 15:09:50 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 15:22:11 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 15:22:11 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 32
2026-01-03 15:22:17 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 15:35:16 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 15:35:16 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 15:35:16 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-03 15:35:17 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 15:35:17 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 15:35:30 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 32
2026-01-03 15:35:30 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 2
2026-01-03 15:36:27 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 15:44:02 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 1232
2026-01-03 15:44:02 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 32
2026-01-03 15:44:07 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 16:02:12 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 194, in run_detection
    output = predictor.predict(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\inference\predictor.py", line 99, in predict
    DataValidator.validate(df, training=False)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\data_pipeline\data_validation.py", line 68, in validate
    raise DataValidationException(
fraudapp.ml_engine.data_pipeline.data_validation.DataValidationException: Missing required raw columns: {'app', 'click_time', 'device'}
2026-01-03 16:07:54 | INFO | fraudapp.ml_engine.inference.predictor | Unique IPs: 25321
2026-01-03 16:07:54 | INFO | fraudapp.ml_engine.inference.predictor | Risky IPs detected: 8163
2026-01-03 16:08:24 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 20:16:29 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 20:16:29 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 20:16:29 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-03 20:16:59 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 20:16:59 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 20:17:59 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 20:23:47 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 20:23:47 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 20:23:47 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-03 20:24:13 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 20:24:13 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 20:27:21 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 20:32:20 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 20:32:20 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 20:32:20 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.26
2026-01-03 20:32:45 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 20:32:45 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 20:34:32 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 20:36:09 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 20:36:09 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 20:36:10 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.50
2026-01-03 20:36:11 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 20:36:11 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 20:36:19 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 20:44:47 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 20:44:47 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 20:44:47 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.50
2026-01-03 20:45:13 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 20:45:13 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 20:46:43 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 21:16:48 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 21:16:48 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 21:16:48 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.40
2026-01-03 21:16:58 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 21:16:58 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 21:17:42 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 21:20:16 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 21:20:16 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 21:20:16 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.30
2026-01-03 21:20:28 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 21:20:28 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 21:21:20 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 21:22:33 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 21:22:33 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 21:22:33 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 21:22:47 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 21:22:47 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 21:24:19 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:05:28 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 22:05:28 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 22:05:28 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 22:05:36 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 22:05:36 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 22:06:30 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:10:22 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 22:10:22 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 22:10:22 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 22:10:29 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 22:10:29 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 22:11:30 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:22:16 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:25:46 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 22:25:46 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 22:25:46 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 22:25:57 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 22:25:57 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 22:27:28 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:31:59 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 22:31:59 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 22:31:59 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 22:31:59 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 22:31:59 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 22:32:02 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:36:49 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:43:11 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 22:43:11 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 22:43:11 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 22:43:12 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 22:43:12 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 22:43:14 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 22:44:54 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 23:10:01 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 23:10:01 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 23:10:01 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 23:10:11 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 23:10:11 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 23:11:17 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-03 23:20:24 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-03 23:20:24 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-03 23:20:24 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-03 23:20:34 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-03 23:20:34 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-03 23:21:48 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 00:21:46 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 00:21:46 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 00:21:46 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-04 00:22:14 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 00:22:14 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 00:23:53 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:10:26 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 11:10:26 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 11:10:26 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-04 11:10:29 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 11:10:29 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 11:16:34 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:18:32 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:26:50 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 11:26:50 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 11:26:50 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.20
2026-01-04 11:27:07 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 11:27:07 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 11:27:11 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:29:09 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 11:29:09 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 11:29:09 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.10
2026-01-04 11:29:25 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 11:29:25 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 11:29:37 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:32:07 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 11:32:07 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 11:32:07 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.06
2026-01-04 11:32:33 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 11:32:33 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 11:35:24 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:36:37 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:42:44 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:47:12 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:48:10 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 11:48:10 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 11:48:10 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.01
2026-01-04 11:48:21 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 11:48:21 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 11:48:29 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:56:22 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 11:58:01 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 11:58:01 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 11:58:01 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.01
2026-01-04 11:58:02 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 11:58:02 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 11:58:15 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 12:02:20 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 12:02:46 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 12:02:46 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\sqlite3\base.py", line 360, in execute
    return super().execute(query, params)
sqlite3.IntegrityError: UNIQUE constraint failed: fraudapp_predictionresult.dataset_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 203, in run_detection
    PredictionResult.objects.create(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\query.py", line 665, in create
    obj.save(force_insert=True, using=self.db)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 902, in save
    self.save_base(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1008, in save_base
    updated = self._save_table(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1169, in _save_table
    results = self._do_insert(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\base.py", line 1210, in _do_insert
    return manager._insert(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\query.py", line 1873, in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\models\sql\compiler.py", line 1882, in execute_sql
    cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 122, in execute
    return super().execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 79, in execute
    return self._execute_with_wrappers(
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 92, in _execute_with_wrappers
    return executor(sql, params, many, context)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 100, in _execute
    with self.db.wrap_database_errors:
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\utils.py", line 91, in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\utils.py", line 105, in _execute
    return self.cursor.execute(sql, params)
  File "D:\ad_click_fraud_classification\venv\lib\site-packages\django\db\backends\sqlite3\base.py", line 360, in execute
    return super().execute(query, params)
django.db.utils.IntegrityError: UNIQUE constraint failed: fraudapp_predictionresult.dataset_id
2026-01-04 12:03:58 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 12:03:58 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 12:03:58 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.01
2026-01-04 12:03:58 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 12:03:58 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 12:04:21 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 12:07:52 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\data_pipeline\sequence_builder.py", line 103, in build
    raise SequenceBuilderException(
fraudapp.ml_engine.data_pipeline.sequence_builder.SequenceBuilderException: Not enough data to build sequences

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 199, in run_detection
    output = predictor.predict(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\inference\predictor.py", line 130, in predict
    X_seq, _, click_index_map = build_sequences(
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\data_pipeline\sequence_builder.py", line 141, in build_sequences
    return builder.build(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\data_pipeline\sequence_builder.py", line 118, in build
    raise SequenceBuilderException(str(e))
fraudapp.ml_engine.data_pipeline.sequence_builder.SequenceBuilderException: Not enough data to build sequences
2026-01-04 15:50:54 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 15:50:54 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 15:50:54 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.01
2026-01-04 15:51:21 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\data_pipeline\sequence_builder.py", line 103, in build
    raise SequenceBuilderException(
fraudapp.ml_engine.data_pipeline.sequence_builder.SequenceBuilderException: Not enough data to build sequences

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 199, in run_detection
    output = predictor.predict(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\inference\predictor.py", line 130, in predict
    X_seq, _, click_index_map = build_sequences(
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\data_pipeline\sequence_builder.py", line 141, in build_sequences
    return builder.build(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\data_pipeline\sequence_builder.py", line 118, in build
    raise SequenceBuilderException(str(e))
fraudapp.ml_engine.data_pipeline.sequence_builder.SequenceBuilderException: Not enough data to build sequences
2026-01-04 15:56:34 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 15:56:34 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 15:57:37 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 15:59:35 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 16:06:01 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-04 16:15:44 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-04 16:15:44 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model
2026-01-04 16:15:44 | INFO | fraudapp.ml_engine.inference.predictor | Training threshold=0.80 | Inference threshold=0.01
2026-01-04 16:15:44 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model
2026-01-04 16:15:44 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 16:15:46 | ERROR | fraudapp.views | Fraud detection failed
Traceback (most recent call last):
  File "D:\ad_click_fraud_classification\fraudapp\views.py", line 199, in run_detection
    output = predictor.predict(df)
  File "D:\ad_click_fraud_classification\fraudapp\ml_engine\inference\predictor.py", line 221, in predict
    weight = HOURLY_TRAFFIC_WEIGHTS.get(hour, 1.0)
NameError: name 'HOURLY_TRAFFIC_WEIGHTS' is not defined
2026-01-04 23:07:55 | INFO | __main__ | Starting FULL training pipeline
2026-01-04 23:08:06 | INFO | __main__ | Sequences | Train=799705 | Val=199927 | Fraud Ratio=0.1169
2026-01-04 23:08:06 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-04 23:08:10 | INFO | fraudapp.ml_engine.training.deep_trainer | Training unified CNN-RNN deep model
2026-01-04 23:08:10 | INFO | fraudapp.ml_engine.training.deep_trainer | Deep model pos_weight=7.55 (pos=93494, neg=706211)
2026-01-04 23:10:25 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 1/5 | Train Loss: 0.7909
2026-01-04 23:12:41 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 2/5 | Train Loss: 0.6181
2026-01-04 23:15:16 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 3/5 | Train Loss: 0.5493
2026-01-04 23:17:39 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 4/5 | Train Loss: 0.5248
2026-01-04 23:21:06 | INFO | fraudapp.ml_engine.training.deep_trainer | Epoch 5/5 | Train Loss: 0.5080
2026-01-04 23:21:06 | INFO | fraudapp.ml_engine.training.deep_trainer | Saved deep_model.pt
2026-01-04 23:22:12 | INFO | fraudapp.ml_engine.training.smote_handler | Before SMOTE: {0: 706211, 1: 93494}
2026-01-04 23:24:45 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.900185615013458, 'precision': 0.643630020991573, 'recall': 0.8987270075473301, 'f1_score': 0.7500827266710788, 'specificity': 0.9004773360936038, 'false_positive_rate': 0.09952266390639625, 'true_positives': 126938, 'false_positives': 70284, 'false_negatives': 14304, 'true_negatives': 635927, 'roc_auc': 0.9592501184954685}
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8983478969823986, 'precision': 0.5394709597266798, 'recall': 0.8917554443160912, 'f1_score': 0.6722572529794062, 'specificity': 0.8992206350465014, 'false_positive_rate': 0.10077936495349865, 'true_positives': 20843, 'false_positives': 17793, 'false_negatives': 2530, 'true_negatives': 158761, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:46 | INFO | __main__ | [XGBOOST METRICS] TRAIN | Acc=0.9002 | Prec=0.6436 | Recall=0.8987 | F1=0.7501 | AUC=0.9593
2026-01-04 23:24:46 | INFO | __main__ | [XGBOOST METRICS] VAL   | Acc=0.8983 | Prec=0.5395 | Recall=0.8918 | F1=0.6723 | AUC=0.9488
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.6813737014010114, 'precision': 0.2642268342589886, 'recall': 0.9668420827450477, 'f1_score': 0.4150305790739959, 'specificity': 0.6435821335115602, 'false_positive_rate': 0.3564178664884398, 'true_positives': 22598, 'false_positives': 62927, 'false_negatives': 775, 'true_negatives': 113627, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.7624983118838377, 'precision': 0.3243837771691626, 'recall': 0.9526804432464809, 'f1_score': 0.48397578708282163, 'specificity': 0.7373211595319279, 'false_positive_rate': 0.2626788404680721, 'true_positives': 22267, 'false_positives': 46377, 'false_negatives': 1106, 'true_negatives': 130177, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:46 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8077398250361382, 'precision': 0.37236295856985513, 'recall': 0.9401873957130021, 'f1_score': 0.5334514735155605, 'specificity': 0.7902058293779807, 'false_positive_rate': 0.20979417062201933, 'true_positives': 21975, 'false_positives': 37040, 'false_negatives': 1398, 'true_negatives': 139514, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8423674641244054, 'precision': 0.4210771199255554, 'recall': 0.9292773713258888, 'f1_score': 0.5795477286371823, 'specificity': 0.8308619459202283, 'false_positive_rate': 0.16913805407977162, 'true_positives': 21720, 'false_positives': 29862, 'false_negatives': 1653, 'true_negatives': 146692, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8625948471191985, 'precision': 0.45653926101896236, 'recall': 0.920891627091088, 'f1_score': 0.6104454118748138, 'specificity': 0.854877261347803, 'false_positive_rate': 0.14512273865219708, 'true_positives': 21524, 'false_positives': 25622, 'false_negatives': 1849, 'true_negatives': 150932, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8752944824861074, 'precision': 0.48237501978429465, 'recall': 0.9127625893124546, 'f1_score': 0.6311834319526627, 'specificity': 0.8703342886595602, 'false_positive_rate': 0.12966571134043975, 'true_positives': 21334, 'false_positives': 22893, 'false_negatives': 2039, 'true_negatives': 153661, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8843127741625694, 'precision': 0.5028974492946373, 'recall': 0.9059598682240192, 'f1_score': 0.6467722475908306, 'specificity': 0.8814470360343011, 'false_positive_rate': 0.11855296396569888, 'true_positives': 21175, 'false_positives': 20931, 'false_negatives': 2198, 'true_negatives': 155623, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:47 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8916854651947961, 'precision': 0.521316194352077, 'recall': 0.898814871860694, 'f1_score': 0.659892258642082, 'specificity': 0.890741642783511, 'false_positive_rate': 0.10925835721648901, 'true_positives': 21008, 'false_positives': 19290, 'false_negatives': 2365, 'true_negatives': 157264, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.8983478969823986, 'precision': 0.5394709597266798, 'recall': 0.8917554443160912, 'f1_score': 0.6722572529794062, 'specificity': 0.8992206350465014, 'false_positive_rate': 0.10077936495349865, 'true_positives': 20843, 'false_positives': 17793, 'false_negatives': 2530, 'true_negatives': 158761, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9047852466150145, 'precision': 0.5587017135432175, 'recall': 0.8830274248064005, 'f1_score': 0.6843850515634844, 'specificity': 0.907665643372566, 'false_positive_rate': 0.0923343566274341, 'true_positives': 20639, 'false_positives': 16302, 'false_negatives': 2734, 'true_negatives': 160252, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9103572804073486, 'precision': 0.5774311770220745, 'recall': 0.8695931202669747, 'f1_score': 0.6940176193402992, 'specificity': 0.9157538203609095, 'false_positive_rate': 0.08424617963909059, 'true_positives': 20325, 'false_positives': 14874, 'false_negatives': 3048, 'true_negatives': 161680, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.916569547884978, 'precision': 0.6006254322398292, 'recall': 0.8546185769905447, 'f1_score': 0.7054564718347166, 'specificity': 0.9247708916252252, 'false_positive_rate': 0.07522910837477485, 'true_positives': 19975, 'false_positives': 13282, 'false_negatives': 3398, 'true_negatives': 163272, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9222666273189715, 'precision': 0.6256900757478495, 'recall': 0.8340392760877936, 'f1_score': 0.7149956903665939, 'specificity': 0.9339465545951947, 'false_positive_rate': 0.06605344540480533, 'true_positives': 19494, 'false_positives': 11662, 'false_negatives': 3879, 'true_negatives': 164892, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:48 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:49 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9275935716536536, 'precision': 0.6546282456811151, 'recall': 0.8057587815000213, 'f1_score': 0.7223735184687967, 'specificity': 0.9437226004508535, 'false_positive_rate': 0.056277399549146435, 'true_positives': 18833, 'false_positives': 9936, 'false_negatives': 4540, 'true_negatives': 166618, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:49 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:49 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9320852111020522, 'precision': 0.6880254923791608, 'recall': 0.7667394001625808, 'f1_score': 0.7252529340348037, 'specificity': 0.9539744214234739, 'false_positive_rate': 0.046025578576526165, 'true_positives': 17921, 'false_positives': 8126, 'false_negatives': 5452, 'true_negatives': 168428, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:49 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:49 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9353063868311934, 'precision': 0.730879815986199, 'recall': 0.7069267958755829, 'f1_score': 0.7187037842540235, 'specificity': 0.9655402879572256, 'false_positive_rate': 0.03445971204277445, 'true_positives': 16523, 'false_positives': 6084, 'false_negatives': 6850, 'true_negatives': 170470, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:49 | INFO | fraudapp.ml_engine.evaluation | Evaluating model predictions
2026-01-04 23:24:49 | INFO | fraudapp.ml_engine.evaluation | Evaluation metrics: {'accuracy': 0.9353013850055271, 'precision': 0.7910439437876422, 'recall': 0.6068968467890301, 'f1_score': 0.6868417867086309, 'specificity': 0.9787770313898297, 'false_positive_rate': 0.02122296861017026, 'true_positives': 14185, 'false_positives': 3747, 'false_negatives': 9188, 'true_negatives': 172807, 'roc_auc': 0.9488223706309118}
2026-01-04 23:24:49 | INFO | __main__ | [TRAINING COMPLETE] Best Threshold=0.80 | Val F1=0.7253
2026-01-05 00:06:45 | INFO | fraudapp.views | Using UPDATED FraudPredictor
2026-01-05 00:06:49 | INFO | fraudapp.ml_engine.training.model_registry | Building CNN-RNN model (input_dim=14)
2026-01-05 00:07:19 | INFO | fraudapp.ml_engine.explainability.shap_explainer | Generating SHAP explanations (behavior-level aggregation)
2026-01-10 15:06:01 | INFO | fraudapp.ml_engine.inference.predictor | Loading trained XGBoost model (inference)
2026-01-10 15:06:01 | INFO | fraudapp.ml_engine.inference.predictor | Loading CNNRNN model (inference)
