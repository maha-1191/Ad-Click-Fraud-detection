{% extends "base.html" %}
{% load static %}
{% block content %}

<!-- ================= USER PROFILE ================= -->
<div class="card shadow-sm p-4 mb-4">
    <h4 class="mb-3">
        <i class="fa-solid fa-user me-2"></i>
        User Profile
    </h4>

    <p class="mb-1">
        <strong>Username:</strong>
        {{ user_obj.username }}
    </p>

    <p class="mb-1">
        <strong>Email:</strong>
        {{ user_obj.email|default:"Not provided" }}
    </p>

    <p class="mb-0">
        <strong>Joined on:</strong>
        {{ user_obj.date_joined|date:"d M Y" }}
    </p>
</div>

<!-- ================= DATASET HISTORY ================= -->
<div class="card shadow-sm p-4">
    <h5 class="mb-3">
        Uploaded Datasets ({{ total_datasets }})
    </h5>

    {% if datasets %}
    <div class="table-responsive">
        <table class="table table-hover align-middle">
            <thead class="table-light">
                <tr>
                    <th>File Name</th>
                    <th>Rows</th>
                    <th>Status</th>
                    <th>Uploaded On</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
            {% for ds in datasets %}
                <tr>
                    <td>{{ ds.original_filename }}</td>
                    <td>{{ ds.total_rows }}</td>
                    <td>
                        <span class="badge
                            {% if ds.status == 'PROCESSED' %}bg-success
                            {% elif ds.status == 'FAILED' %}bg-danger
                            {% else %}bg-warning{% endif %}">
                            {{ ds.status }}
                        </span>
                    </td>
                    <td>{{ ds.created_at|date:"d M Y, H:i" }}</td>
                    <td>
                        {% if ds.status == "PROCESSED" %}
                        <a href="{% url 'dashboard' %}?dataset_id={{ ds.id }}"
                           class="btn btn-sm btn-outline-primary">
                            View on Dashboard
                        </a>

                        {% else %}
                        <span class="text-muted">N/A</span>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
        <p class="text-muted text-center mb-0">
            No datasets uploaded yet.
        </p>
    {% endif %}
</div>

{% endblock %}




