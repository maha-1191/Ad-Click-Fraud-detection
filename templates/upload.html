{% extends "base.html" %}
{% load static %}
{% block content %}

<!-- ================= UPLOAD CARD ================= -->
<div class="card shadow-sm p-4 mb-4">
    <h4 class="mb-2">
        <i class="fa-solid fa-upload me-2"></i>
        Upload Clickstream Dataset
    </h4>
    <p class="text-muted">
        Upload a CSV file to run fraud detection.
    </p>

    <!-- Upload form -->
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input
            type="file"
            name="dataset"
            class="form-control mb-3"
            accept=".csv"
            required
        >
        <button class="btn btn-primary">
            <i class="fa-solid fa-cloud-arrow-up me-2"></i>
            Upload Dataset
        </button>
    </form>
</div>

<!-- ================= AFTER UPLOAD ================= -->
{% if dataset %}
<div class="card shadow-sm p-4 text-center">
    <h5 class="mb-3 text-success">
        <i class="fa-solid fa-check-circle me-2"></i>
        Dataset Uploaded Successfully
    </h5>

    <p class="text-muted mb-3">
        <strong>File:</strong> {{ dataset.original_filename }} <br>
        <strong>Rows:</strong> {{ dataset.total_rows }} <br>
        <strong>Columns:</strong> {{ dataset.total_columns }}
    </p>

    <p class="text-muted mb-4">
        You can now run fraud detection on this dataset.
        Results will appear on the dashboard.
    </p>

    <!-- Run Detection -->
    <form method="post" action="{% url 'run_detection' dataset.id %}">
        {% csrf_token %}
        <button class="btn btn-success px-4 py-2">
            <i class="fa-solid fa-play me-2"></i>
            Run Fraud Detection
        </button>
    </form>

    <div class="mt-3">
        <a href="{% url 'dashboard' %}" class="btn btn-outline-secondary">
            Go to Dashboard
        </a>
    </div>
</div>
{% endif %}

{% endblock %}




